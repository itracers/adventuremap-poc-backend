version: 2.1
executors:
  my-custom-executor:
    docker:
      - image: cimg/node:16.10.0
      
jobs:
  deploy:
    environment:
      SSH_HOST: deploy@151.115.33.89
    executor: my-custom-executor
    steps:
      - checkout
      - run: |
          ls -lha;
          du;
          sudo npm i -g npm;
          npm i;
          zip build.zip -r .;
          chmod +x ./install.sh;
          scp -o StrictHostKeyChecking=no build.zip $SSH_HOST:build.zip;
          scp -o StrictHostKeyChecking=no install.sh SSH_HOST:install.sh;
          ssh -o StrictHostKeyChecking=no $SSH_HOST './install.sh';

workflows:
  adventuremap-deploy:
    jobs:
      - deploy